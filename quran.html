<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ - Ù‚Ø±Ø§Ø¡Ø© ÙˆØ§Ø³ØªÙ…Ø§Ø¹</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-site: #f4f4f4;
            --paper-color: #fffaf0;
            --gold: #d4a74c;
            --dark-blue: #1a237e;
            --success: #27ae60;
        }

        /* Ù…Ù†Ø¹ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ù‚ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ */
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        body {
            background-color: var(--bg-site);
            font-family: 'Tajawal', sans-serif;
            margin: 0;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ø§Ù„Ù…ØªÙØ§Ø¹Ù„ */
        .back-home {
            align-self: flex-start;
            background: var(--dark-blue);
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border: none;
            display: inline-block;
        }

        .back-home:hover {
            background: var(--gold);
            transform: scale(1.05);
            color: #000;
        }

        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¹Ù„ÙˆÙŠØ© */
        .controls-container {
            display: flex;
            gap: 15px;
            width: 100%;
            max-width: 800px;
            margin-bottom: 25px;
        }

        .select-wrapper {
            flex: 1;
            background: #fbe9d0;
            border: 1px solid #e2d2b5;
            border-radius: 12px;
            padding: 5px 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        select {
            width: 100%;
            border: none;
            background: transparent;
            font-family: 'Tajawal', sans-serif;
            font-weight: bold;
            font-size: 16px;
            padding: 10px;
            cursor: pointer;
            color: #444;
        }

        /* ÙˆØ±Ù‚Ø© Ø§Ù„Ù…ØµØ­Ù */
        .quran-container {
            width: 100%;
            max-width: 800px;
            background-color: var(--paper-color);
            border: 1px solid #d3c4a9;
            border-radius: 15px;
            padding: 35px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            display: none; /* ØªØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø³ÙˆØ±Ø© */
            flex-direction: column;
            align-items: center;
        }

        .surah-header {
            width: 100%;
            text-align: center;
            border-bottom: 1px solid #eee;
            margin-bottom: 30px;
            padding-bottom: 20px;
        }

        .surah-name {
            font-family: 'Amiri', serif;
            font-size: clamp(2.2rem, 7vw, 3.8rem);
            color: #8b4513;
            margin: 0 0 15px 0;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„ */
        .audio-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            width: 100%;
            margin-bottom: 20px;
        }

        audio {
            width: 100%;
            max-width: 450px;
            height: 45px;
        }

        .btn-download {
            background-color: var(--success);
            color: white;
            padding: 10px 30px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            font-size: 15px;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-download:hover {
            background-color: #219150;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }

        /* Ù†Øµ Ø§Ù„Ù‚Ø±Ø¢Ù† */
        .quran-text {
            font-family: 'Amiri', serif;
            font-size: clamp(1.6rem, 5vw, 2.5rem);
            line-height: 2.3;
            text-align: justify;
            color: #2c1e0f;
            width: 100%;
            word-spacing: 3px;
        }

        .ayah-mark {
            color: var(--gold);
            font-weight: bold;
            margin: 0 6px;
            font-size: 0.85em;
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        #loader {
            display: none;
            color: var(--gold);
            font-weight: bold;
            margin-top: 20px;
        }

        @media (max-width: 600px) {
            .controls-container { flex-direction: column; }
            .quran-container { padding: 20px; }
            .back-home { width: 100%; text-align: center; }
        }
    </style>
</head>
<body>

    <a href="index.html" class="back-home">â¬… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>

    <div class="controls-container">
        <div class="select-wrapper">
            <select id="surahSelect" onchange="loadSurah()">
                <option value="">â–¼ Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ±Ø©</option>
            </select>
        </div>
        <div class="select-wrapper">
            <select id="reciterSelect" onchange="updateAudio()">
                <option value="ar.alafasy">Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ</option>
                <option value="ar.abdulbasitmurattal">Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ø³Ø· (Ù…Ø±ØªÙ„)</option>
            </select>
        </div>
    </div>

    <div id="loader">Ø¬Ø§Ø±ÙŠ ÙØªØ­ Ø§Ù„Ù…ØµØ­Ù...</div>

    <div class="quran-container" id="mainDisplay">
        <div class="surah-header">
            <h2 id="surahTitle" class="surah-name"></h2>
            <div class="audio-section">
                <audio id="player" controls></audio>
                <a id="downloadLink" class="btn-download" href="#" target="_blank" download>ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø© MP3</a>
            </div>
        </div>
        <div id="quranContent" class="quran-text"></div>
    </div>

    <script>
        const surahSelect = document.getElementById('surahSelect');
        const mainDisplay = document.getElementById('mainDisplay');
        const quranContent = document.getElementById('quranContent');
        const surahTitle = document.getElementById('surahTitle');
        const player = document.getElementById('player');
        const reciterSelect = document.getElementById('reciterSelect');
        const downloadLink = document.getElementById('downloadLink');
        const loader = document.getElementById('loader');

        // 1. Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙˆØ±
        async function fetchSurahs() {
            try {
                const response = await fetch('https://api.alquran.cloud/v1/surah');
                const data = await response.json();
                data.data.forEach(surah => {
                    let option = document.createElement('option');
                    option.value = surah.number;
                    option.text = surah.name;
                    surahSelect.appendChild(option);
                });
            } catch (err) {
                alert("ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.");
            }
        }

        // 2. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
        async function loadSurah() {
            const sNumber = surahSelect.value;
            if (!sNumber) {
                mainDisplay.style.display = "none";
                return;
            }

            loader.style.display = "block";
            mainDisplay.style.display = "none";

            try {
                const response = await fetch(`https://api.alquran.cloud/v1/surah/${sNumber}/quran-uthmani`);
                const data = await response.json();
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                surahTitle.innerText = "ï´¿ " + data.data.name + " ï´¾";
                quranContent.innerHTML = data.data.ayahs.map(ayah => 
                    ayah.text + ` <span class="ayah-mark">(${ayah.numberInSurah})</span>`
                ).join(" ");

                updateAudio(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØª

                loader.style.display = "none";
                mainDisplay.style.display = "flex";
            } catch (err) {
                loader.innerText = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø©.";
            }
        }

        // 3. ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„
        function updateAudio() {
            const sNumber = surahSelect.value;
            const reciter = reciterSelect.value;
            if (sNumber && reciter) {
                const audioUrl = `https://cdn.islamic.network/quran/audio-surah/128/${reciter}/${sNumber}.mp3`;
                player.src = audioUrl;
                downloadLink.href = audioUrl;
                // player.play(); // Ø§Ø®ØªÙŠØ§Ø± Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            }
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        window.onload = fetchSurahs;
    </script>
</body>
</html>